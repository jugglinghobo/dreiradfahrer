- text = page.paragraphs.find_or_initialize_by(:rank => 0)
- photo = page.photos.find_or_initialize_by(:rank => 0)
= form_for :page, url(:pages, :update, :id => page.id), :method => :put, :multipart => true, :class => 'form-horizontal' do |f|
  #layout-text-top-pic-bottom.layout
    .row.form
      .col-xs-2
      #text.col-xs-8
        = f.fields_for :paragraphs, text do |ff|
          = ff.hidden_field :rank, :value => text.rank
          ~ ff.text_area :content, :placeholder => "Text...", :class => 'form-control'
      .col-xs-2

    .row.form
      .col-xs-4
      #photo-field.col-xs-4
        = f.fields_for :photos, photo do |ff|
          = ff.hidden_field :rank, :value => photo.rank
          %fieldset.control-group
            .controls
              = ff.file_field :picture, :class => 'form-control input-large input-with-feedback'
      .col-xs-4
    .row.form
      .col-xs-2
      #photo.col-xs-8
        = image_tag photo.picture.url(:small) if photo.picture.exists?
      .col-xs-2
  .form-actions
    = partial 'pages/form_actions', :locals => { :f => f }
